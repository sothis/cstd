#include "kfile.h"

typedef const uint64_t complexity_array_t[KFILE_VERSION_MAX][256];

static complexity_array_t kdf_iterations = {
	{
		10303, 10627, 10937, 11251, 11551, 11887, 12161, 12473,
		12739, 13033, 13337, 13681, 13933, 14323, 14627, 14887,
		15217, 15473, 15773, 16087, 16427, 16747, 17053, 17389,
		17683, 17989, 18289, 18593, 19009, 19373, 19603, 19961,
		20233, 20551, 20903, 21193, 21523, 21821, 22123, 22453,
		22769, 23063, 23417, 23743, 24023, 24359, 24709, 25073,
		25391, 25717, 26029, 26357, 26699, 26987, 27361, 27737,
		28001, 28387, 28649, 28961, 29303, 29633, 30029, 30341,
		30703, 31039, 31321, 31687, 32063, 32363, 32647, 32987,
		33329, 33613, 33923, 34297, 34603, 34939, 35291, 35603,
		35999, 36341, 36677, 36947, 37321, 37607, 37993, 38333,
		38713, 39047, 39367, 39727, 40039, 40433, 40813, 41141,
		41453, 41771, 42073, 42397, 42701, 43013, 43427, 43783,
		44119, 44497, 44797, 45161, 45533, 45869, 46261, 46601,
		46933, 47317, 47653, 47969, 48371, 48679, 49033, 49367,
		49697, 50033, 50359, 50753, 51133, 51439, 51767, 52103,
		52501, 52837, 53161, 53549, 53881, 54269, 54559, 54919,
		55291, 55663, 55949, 56333, 56659, 56951, 57269, 57653,
		57977, 58313, 58679, 59029, 59359, 59669, 60083, 60443,
		60779, 61169, 61553, 61927, 62233, 62633, 62989, 63389,
		63671, 64019, 64439, 64849, 65171, 65539, 65837, 66191,
		66593, 66949, 67273, 67601, 67943, 68371, 68737, 69119,
		69467, 69899, 70223, 70573, 70937, 71263, 71563, 71933,
		72253, 72649, 72973, 73379, 73721, 74131, 74449, 74797,
		75181, 75533, 75853, 76249, 76607, 77003, 77351, 77659,
		78017, 78427, 78791, 79181, 79549, 79867, 80231, 80621,
		80923, 81239, 81637, 81971, 82301, 82651, 83063, 83423,
		83813, 84199, 84521, 84947, 85297, 85643, 86077, 86371,
		86767, 87151, 87523, 87811, 88259, 88721, 89041, 89393,
		89689, 90031, 90397, 90793, 91153, 91499, 91939, 92269,
		92623, 92899, 93257, 93607, 94009, 94399, 94771, 95101,
		95441, 95789, 96167, 96517, 96907, 97303, 97673, 98057
	},
	{
		10303, 10627, 10937, 11251, 11551, 11887, 12161, 12473,
		12739, 13033, 13337, 13681, 13933, 14323, 14627, 14887,
		15217, 15473, 15773, 16087, 16427, 16747, 17053, 17389,
		17683, 17989, 18289, 18593, 19009, 19373, 19603, 19961,
		20233, 20551, 20903, 21193, 21523, 21821, 22123, 22453,
		22769, 23063, 23417, 23743, 24023, 24359, 24709, 25073,
		25391, 25717, 26029, 26357, 26699, 26987, 27361, 27737,
		28001, 28387, 28649, 28961, 29303, 29633, 30029, 30341,
		30703, 31039, 31321, 31687, 32063, 32363, 32647, 32987,
		33329, 33613, 33923, 34297, 34603, 34939, 35291, 35603,
		35999, 36341, 36677, 36947, 37321, 37607, 37993, 38333,
		38713, 39047, 39367, 39727, 40039, 40433, 40813, 41141,
		41453, 41771, 42073, 42397, 42701, 43013, 43427, 43783,
		44119, 44497, 44797, 45161, 45533, 45869, 46261, 46601,
		46933, 47317, 47653, 47969, 48371, 48679, 49033, 49367,
		49697, 50033, 50359, 50753, 51133, 51439, 51767, 52103,
		52501, 52837, 53161, 53549, 53881, 54269, 54559, 54919,
		55291, 55663, 55949, 56333, 56659, 56951, 57269, 57653,
		57977, 58313, 58679, 59029, 59359, 59669, 60083, 60443,
		60779, 61169, 61553, 61927, 62233, 62633, 62989, 63389,
		63671, 64019, 64439, 64849, 65171, 65539, 65837, 66191,
		66593, 66949, 67273, 67601, 67943, 68371, 68737, 69119,
		69467, 69899, 70223, 70573, 70937, 71263, 71563, 71933,
		72253, 72649, 72973, 73379, 73721, 74131, 74449, 74797,
		75181, 75533, 75853, 76249, 76607, 77003, 77351, 77659,
		78017, 78427, 78791, 79181, 79549, 79867, 80231, 80621,
		80923, 81239, 81637, 81971, 82301, 82651, 83063, 83423,
		83813, 84199, 84521, 84947, 85297, 85643, 86077, 86371,
		86767, 87151, 87523, 87811, 88259, 88721, 89041, 89393,
		89689, 90031, 90397, 90793, 91153, 91499, 91939, 92269,
		92623, 92899, 93257, 93607, 94009, 94399, 94771, 95101,
		95441, 95789, 96167, 96517, 96907, 97303, 97673, 98057
	},
};

uint64_t kfile_get_iteration_count
(kfile_version_t version, uint8_t kdf_complexity)
{
	/* check for version < KFILE_VERSION_MAX here? */
	return kdf_iterations[version][kdf_complexity];
}
